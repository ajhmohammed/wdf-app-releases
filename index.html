<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head><script src="./color-modes.js"></script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.122.0">
    <link rel="icon" href="./img/icon.png" type="image/png">
    <title>Diabetes Compass App Releases</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/checkout/">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
   
    <!-- Custom styles for this template -->
    <link href="checkout.css" rel="stylesheet">
  </head>
  <body class="bg-body-tertiary">
    <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
      <symbol id="check2" viewBox="0 0 16 16">
        <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
      </symbol>
      <symbol id="circle-half" viewBox="0 0 16 16">
        <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
      </symbol>
      <symbol id="moon-stars-fill" viewBox="0 0 16 16">
        <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
      </symbol>
      <symbol id="sun-fill" viewBox="0 0 16 16">
        <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
      </symbol>
    </svg>

    <div class="dropdown position-fixed bottom-0 end-0 mb-3 me-3 bd-mode-toggle">
      <button class="btn btn-bd-primary py-2 dropdown-toggle d-flex align-items-center"
              id="bd-theme"
              type="button"
              aria-expanded="false"
              data-bs-toggle="dropdown"
              aria-label="Toggle theme (auto)">
        <svg class="bi my-1 theme-icon-active" width="1em" height="1em"><use href="#circle-half"></use></svg>
        <span class="visually-hidden" id="bd-theme-text">Toggle theme</span>
      </button>
      <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="bd-theme-text">
        <li>
          <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
            <svg class="bi me-2 opacity-50" width="1em" height="1em"><use href="#sun-fill"></use></svg>
            Light
            <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
          </button>
        </li>
        <li>
          <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
            <svg class="bi me-2 opacity-50" width="1em" height="1em"><use href="#moon-stars-fill"></use></svg>
            Dark
            <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
          </button>
        </li>
        <li>
          <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
            <svg class="bi me-2 opacity-50" width="1em" height="1em"><use href="#circle-half"></use></svg>
            Auto
            <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
          </button>
        </li>
      </ul>
    </div>
    
    <div class="container">
      <main>
        <div class="py-5 text-center">
          <img id="theme-logo" class="d-block mx-auto mb-2" src="./img/dc_color_.png" alt="" width="" height="80">
          <h2>Diabetes Compass App Releases</h2>
        </div>

        <!-- Loading spinner -->
        <div id="loading-spinner" class="d-flex justify-content-center my-4">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>

        <div id="applist">
          <ul class="nav nav-tabs" id="listEnvironment" role="tablist"></ul>
          <br/>
          <div class="tab-content" id="listContent"></div>
        </div>  

        <div id="errorContent"></div>
      </main>
    </div>

    <div id="test"> </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="checkout.js"></script></body>

    <script>

      const spinner = document.getElementById('loading-spinner')
      const applist = document.getElementById('applist')
      const listEnvironment = document.getElementById('listEnvironment')
      const listContent = document.getElementById('listContent')
      const errorContent = document.getElementById('errorContent')    

      fetch('apps.json')
        .then(response => response.json())
        .then(data => {

          data.apps.forEach((apps, index) => {

            // Generating the Tabs
            const list = document.createElement('li');
            list.classList.add("nav-item");
            list.setAttribute('role', 'presentation')
            
            const button = document.createElement('button')
            // if (index === 0 ) {
              // button.classList.add('nav-link', 'active', 'text-capitalize')
            // } else {
              button.classList.add('nav-link', 'text-capitalize')
            // }
            button.setAttribute('id', 'home-tab')
            button.setAttribute('data-bs-toggle', 'tab')
            button.setAttribute('data-bs-target', `#${apps.environment}-tab-pane`)
            button.setAttribute('type', 'button')
            button.setAttribute('role', 'tab')
            button.setAttribute('aria-controls', `${apps.environment}-tab-pane`)
            button.setAttribute('aria-selected', 'true')

            if(apps.status == 'disabled') {
              button.setAttribute('disabled', 'true')
            }

            button.textContent = `${apps.environment}`;
            listEnvironment.appendChild(list);
            listEnvironment.appendChild(button);

            // Generating the tab panels
            const panel = document.createElement('div')
            // panel.classList.add("tab-pane", "fade")
            // if (index === 0 ) {
              // panel.classList.add("tab-pane", "fade", "show", "active")
            // } else {
              panel.classList.add("tab-pane", "fade")
            // }
            panel.setAttribute('id', `${apps.environment}-tab-pane`)
            panel.setAttribute('role', `tabpanel`)
            panel.setAttribute('aria-labelledby', `${apps.environment}-tab-pane`)
            panel.setAttribute('tabindex', `0`)
            // panel.textContent = `${apps.community.length}`

            listContent.appendChild(panel)
            
            if(apps.community.length > 0 || apps.clinic.length > 0) {

              // Create tables
              const table = document.createElement('table')
              table.classList.add("table", "table-hover")

              const thead = document.createElement('thead')

              const headerRow = document.createElement('tr')
              headerRow.classList.add("text-center")
              const headers = ['App Id', 'App Name', 'App Version', 'Labels', 'Release Date', '']
              headers.forEach(headerText => {
                const th = document.createElement('th')
                th.classList.add("table-info")
                th.textContent = headerText
                headerRow.appendChild(th)
              })

              const tbody = document.createElement('tbody');

              // Loop for community app
              if(apps.community.length > 0) {

                apps.community.forEach(community => {

                  const row = document.createElement('tr')
                  row.classList.add("text-center")

                  const appId = document.createElement('td')
                  appId.classList.add("text-capitalize")
                  appId.textContent = community.id
                  row.appendChild(appId)

                  const appNameCell = document.createElement('td')
                  appNameCell.classList.add("text-capitalize")
                  appNameCell.textContent = community.name
                  row.appendChild(appNameCell)

                  const appVersion = document.createElement('td')
                  appVersion.textContent = community.appVersion
                  row.appendChild(appVersion)

                  const labels = document.createElement('td')

                  if(community.labels && community .labels.length > 0) {
                    community.labels.forEach(label => {
                      const labelBadge = document.createElement('span')

                      if (label == 'latest') {
                        labelBadge.classList.add("badge", "text-capitalize", "text-bg-primary", "mx-1")
                      } else if (label == 'stable') {
                        labelBadge.classList.add("badge", "text-capitalize", "text-bg-success", "mx-1")
                      } else {
                        labelBadge.classList.add("badge", "text-capitalize", "text-bg-secondary", "mx-1")
                      }

                      labelBadge.textContent = label
                      labels.appendChild(labelBadge)
                    })
                  }
                  
                  row.appendChild(labels)

                  const lastUpdated = document.createElement('td')
                  lastUpdated.textContent = community.releaseDate
                  row.appendChild(lastUpdated)

                  const actions = document.createElement('td')
                  const downloadBtn = document.createElement('a')
                  downloadBtn.textContent = 'Download';
                  downloadBtn.classList.add('btn', 'btn-primary', 'btn-sm', 'mx-1')
                  downloadBtn.setAttribute('href', `${community.downloadUrl}`)
                  actions.appendChild(downloadBtn)

                  if(community.googleDriveUrl) {
                    const googleDriveBtn = document.createElement('a')
                    googleDriveBtn.textContent = 'Drive Link';
                    googleDriveBtn.classList.add('btn', 'btn-success', 'btn-sm', 'mx-1')
                    googleDriveBtn.setAttribute('href', `${community.googleDriveUrl}`)
                    actions.appendChild(googleDriveBtn)
                  }

                  row.appendChild(actions)

                  tbody.appendChild(row)

                })

              }

              // Loop for clinic app
              if(apps.clinic.length > 0) {

                apps.clinic.forEach(clinic => {

                  const row = document.createElement('tr')
                  row.classList.add("text-center")

                  const appId = document.createElement('td')
                  appId.classList.add("text-capitalize")
                  appId.textContent = clinic.id
                  row.appendChild(appId)

                  const appNameCell = document.createElement('td')
                  appNameCell.classList.add("text-capitalize")
                  appNameCell.textContent = clinic.name
                  row.appendChild(appNameCell)

                  const appVersion = document.createElement('td')
                  appVersion.textContent = clinic.appVersion
                  row.appendChild(appVersion)

                  const labels = document.createElement('td')

                  if(clinic.labels && clinic.labels.length > 0) {
                    clinic.labels.forEach(label => {
                      const labelBadge = document.createElement('span')

                      if (label == 'latest') {
                        labelBadge.classList.add("badge", "text-capitalize", "text-bg-primary", "mx-1")
                      } else if (label == 'stable') {
                        labelBadge.classList.add("badge", "text-capitalize", "text-bg-success", "mx-1")
                      } else {
                        labelBadge.classList.add("badge", "text-capitalize", "text-bg-secondary", "mx-1")
                      }

                      labelBadge.textContent = label
                      labels.appendChild(labelBadge)
                    })
                  }
                  
                  row.appendChild(labels)

                  const lastUpdated = document.createElement('td')
                  lastUpdated.textContent = clinic.releaseDate
                  row.appendChild(lastUpdated)

                  const actions = document.createElement('td')
                  const downloadBtn = document.createElement('a')
                  downloadBtn.textContent = 'Download';
                  downloadBtn.classList.add('btn', 'btn-primary', 'btn-sm')
                  downloadBtn.setAttribute('href', `${clinic.downloadUrl}`)
                  actions.appendChild(downloadBtn)

                  if(clinic.googleDriveUrl) {
                    const googleDriveBtn = document.createElement('a')
                    googleDriveBtn.textContent = 'Drive Link';
                    googleDriveBtn.classList.add('btn', 'btn-success', 'btn-sm', 'mx-1')
                    googleDriveBtn.setAttribute('href', `${clinic.googleDriveUrl}`)
                    actions.appendChild(googleDriveBtn)
                  }
                  row.appendChild(actions)

                  tbody.appendChild(row)

                })

              }


              panel.appendChild(table)
              table.appendChild(thead)
              table.appendChild(tbody)
              thead.appendChild(headerRow)              

            } else {

              const errorDiv = document.createElement('div');
              errorDiv.classList.add('alert', 'alert-warning');
              errorDiv.textContent = `No apps uploaded`;
              panel.appendChild(errorDiv);

            }

            spinner.classList.add('d-none')

          });
        })
        .catch(error => {

          spinner.classList.add('d-none')

          console.error("Error loading JSON: ", error)

          const errorDiv = document.createElement('div');
          errorDiv.classList.add('alert', 'alert-danger');
          errorDiv.textContent = `Failed to load the apps list`;
          errorContent.appendChild(errorDiv);
        })

    </script>
</html>
